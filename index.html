<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HANIL TIMER</title>

    <link rel="manifest" href="manifest.json" />

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Anonymous+Pro&family=Nanum+Myeongjo&display=swap" rel="stylesheet">

    <!-- Tailwind Custom Font ì„¤ì • -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        Inter: ['Inter', 'sans-serif'],
                        Anonymous_Pro: ['"Anonymous Pro"', 'monospace'],
                        NanumMyeongjo: ['"Nanum Myeongjo"', 'serif']
                    },
                    colors: {
                        hanilgreen: "#00AF84",
                        graylight: "#F0F0F0",
                        graymid: "#DFDFDF",
                        graybg: "#F7F7F7",
                        darkgray: "#444444"
                    }
                }
            }
        }
    </script>
  
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/Timer/service-worker.js')
                    .then(() => console.log('âœ… Service Worker ë“±ë¡ ì„±ê³µ'))
                    .catch((err) => console.error('âŒ Service Worker ë“±ë¡ ì‹¤íŒ¨:', err));
            });
        }
    </script>
</head>

<audio id="alarmSound" src="/Timer/alarm.mp3" preload="auto"></audio>

<body class="bg-white font-Inter">
    <!-- ì‚¬ì´ë“œë°” -->
    <div class="w-[180px] h-screen bg-white border-r border-graymid fixed left-0 top-0 p-6">
        <div class="text-black text-xl font-semibold leading-[30px] mb-10">HANIL TIMER</div>
        <div class="space-y-2">
            <div class="h-10 flex items-center gap-4">
                <span class="text-black text-base font-semibold">Features</span>
            </div>
        
            <!-- ëª¨ì˜ê³ ì‚¬ (í˜„ì¬ í˜ì´ì§€) -->
            <div class="px-2 h-10 flex items-center gap-4 bg-graybg rounded-lg">
                <img src="/Timer/PracticeExamTimer.png" class="w-[25px] h-[25px]" />
                <span class="text-black text-base font-medium">ëª¨ì˜ê³ ì‚¬</span>
            </div>
        
            <!-- ìŠ¤í†±ì›Œì¹˜ (ë§í¬ ì¶”ê°€) -->
            <a href="stopwatch.html" class="block px-2 h-10 flex items-center gap-4 hover:bg-graybg rounded-lg">
                <img src="/Timer/Stopwatch.png" class="w-[25px] h-[25px]" />
                <span class="text-black text-base font-medium">ìŠ¤í†±ì›Œì¹˜</span>
            </a>
        
            <!-- íƒ€ì´ë¨¸ (ë§í¬ ì¶”ê°€) -->
            <a href="timer.html" class="block px-2 h-10 flex items-center gap-4 hover:bg-graybg rounded-lg">
                <img src="/Timer/Timer.png" class="w-[25px] h-[26px]" />
                <span class="text-black text-base font-medium">íƒ€ì´ë¨¸</span>
            </a>
        </div>
    </div>
    
    <!-- ìƒë‹¨ë°” -->
    <div class="ml-[180px] w-[906px] h-[197px] p-8">
        <div class="flex justify-between items-center mb-8">
            <div class="flex space-x-2 bg-graybg p-1 rounded-lg" id="subjectButtons">
                <div class="subject-btn px-3 h-8 bg-white rounded-lg shadow flex items-center text-black text-base font-medium cursor-pointer"
                     data-subject="êµ­ì–´" data-time="4800" data-color="#00AF84">êµ­ì–´</div>
                <div class="subject-btn px-3 h-8 flex items-center text-black text-base font-medium cursor-pointer"
                     data-subject="ìˆ˜í•™" data-time="6000" data-color="#E5007F">ìˆ˜í•™</div>
                <div class="subject-btn px-3 h-8 flex items-center text-black text-base font-medium cursor-pointer"
                     data-subject="ì˜ì–´" data-time="4200" data-color="#00A0E8">ì˜ì–´</div>
                <div class="subject-btn px-3 h-8 flex items-center text-black text-base font-medium cursor-pointer"
                     data-subject="íƒêµ¬" data-time="1800" data-color="#004A95">íƒêµ¬</div>
            </div>
            <div class="h-10 px-4 bg-black text-white text-base font-medium rounded-lg flex items-center">for Hanil High</div>
        </div>
        <div>
            <div class="text-black text-[34px] font-semibold leading-[37.40px]">ëª¨ì˜ê³ ì‚¬</div>
            <div class="text-darkgray text-base font-normal">Practice Exam Timer</div>
        </div>
    </div>

    <!-- ë©”ì¸ ì˜ì—­ -->
    <div class="ml-[174px] w-[906px] flex justify-center items-center h-[400px] relative">
        <div data-layer="Clock" class="Clock w-[566px] h-[250px] relative overflow-hidden">
            <div data-layer="ê³¼ëª©ë³„ íƒ€ì´ë¨¸" class="w-[250px] h-[250px] left-[158px] top-0 absolute">
                <!-- í”„ë¡œê·¸ë ˆìŠ¤ ë°°ê²½ -->
                <div id="progressCircle" class="w-full h-full rounded-full relative">
                    <!-- íšŒì „ ì±„ìš°ê¸° ì› -->
                    <div id="fillCircle" class="absolute inset-0 rounded-full bg-[conic-gradient(#f0f0f0_0%,#00af84_0%)]"></div>
                    <!-- ì•ˆìª½ í°ìƒ‰ ì› (ì‹œê³„ ì¤‘ì•™ íš¨ê³¼) -->
                    <div class="absolute inset-[15.62px] rounded-full bg-white shadow-[inset_0px_4px_10px_0px_rgba(0,0,0,0.25)]"></div>
                </div>
            </div>
            <!-- Reset ë²„íŠ¼ -->
            <div id="resetButton" class="w-[100px] h-[100px] left-[466px] top-[65px] absolute cursor-pointer">
                <div class="w-[100px] h-[100px] bg-[#f0f0f0] rounded-full shadow-[inset_0px_1px_10px_0px_rgba(0,0,0,0.25)]"></div>
                <img src="/Timer/Reset.png" class="w-[41.67px] h-[41.67px] left-[29px] top-[29px] absolute" />
            </div>
            <!-- Play ë²„íŠ¼ -->
            <div id="playButton" class="PlayStop w-[100px] h-[100px] left-0 top-[65px] absolute cursor-pointer">
                <div class="Ellipse3 w-[100px] h-[100px] bg-[#f0f0f0] rounded-full shadow-[inset_0px_1px_10px_0px_rgba(0,0,0,0.25)]"></div>
                <img src="/Timer/Play.png" class="w-[41.67px] h-[41.67px] left-[33px] top-[29px] absolute" style="pointer-events: none;" />
            </div>
            <!-- Stop ë²„íŠ¼ -->
            <div id="stopButton" class="PlayStop w-[100px] h-[100px] left-0 top-[65px] absolute hidden cursor-pointer">
                <div class="Ellipse3 w-[100px] h-[100px] bg-[#f0f0f0] rounded-full shadow-[inset_0px_1px_10px_0px_rgba(0,0,0,0.25)]"></div>
                <img src="/Timer/Stop.png" class="w-[33.33px] h-[33.33px] left-[33px] top-[33px] absolute" style="pointer-events: none;" />
            </div>
            <div data-layer="80:00" class="timer-text left-[217px] top-[89px] absolute justify-center text-black text-5xl font-normal font-['Anonymous_Pro'] leading-[72px]">00:00</div>
        </div>
        <div class="absolute bottom-0 right-10 text-black text-xl font-NanumMyeongjo">í•œì¼ê³ ë“±í•™êµ í•™ìƒìì¹˜ì •ë¶€ ì •ë³´ë¶€</div>
    </div>

    <style>
      #fillCircle {
        background: conic-gradient(#f0f0f0 0%, #00af84 0%);
        transition: background 1s linear;
      }
    </style>

    <script>
        const timerDisplay = document.querySelector(".timer-text");
        const playButton = document.getElementById("playButton");
        const stopButton = document.getElementById("stopButton");
        const resetButton = document.getElementById("resetButton");
        const fillCircle = document.getElementById("fillCircle");
        const alarmSound = document.getElementById("alarmSound");
    
        let totalTime = 10; // ê¸°ë³¸: êµ­ì–´ (80ë¶„)
        let timeLeft = totalTime;
        let timerInterval;
    
        function updateProgress() {
            const percent = (1 - timeLeft / totalTime) * 100;
            fillCircle.style.background = `conic-gradient(#f0f0f0 ${percent}%, ${currentColor} ${percent}%)`;
        }
    
        function updateDisplay() {
            const time = Math.max(0, Math.floor(timeLeft));
        
            // íŠ¹ë³„ ì¡°ê±´: ì´ ì‹œê°„ì´ 6000ì´ˆ(100ë¶„)ì¼ ë•Œë§Œ ì˜ˆì™¸ì ìœ¼ë¡œ í‘œì‹œ
            if (totalTime === 6000) {
                const minutes = Math.floor(time / 60); // 100, 99, ...
                const seconds = Math.floor(time % 60); // 0 ~ 59
                timerDisplay.textContent = `${minutes}:${seconds}`;
            } else {
                const minutes = String(Math.floor(time / 60)).padStart(2, '0');
                const seconds = String(time % 60).padStart(2, '0');
                timerDisplay.textContent = `${minutes}:${seconds}`;
            }
        
            updateProgress();
        }

        function stopTimer() {
            clearInterval(timerInterval);
            stopButton.classList.add("hidden");
            playButton.classList.remove("hidden");
        }
    
        function resetTimer() {
            stopTimer();
            timeLeft = totalTime;
            updateDisplay();
        }
    
        let currentColor = "#00AF84"; // ì´ˆê¸° êµ­ì–´ ìƒ‰ìƒ
    
        playButton.addEventListener("click", () => {
            playButton.classList.add("hidden");
            stopButton.classList.remove("hidden");

            alarmSound.volume = 0;
            alarmSound.play().then(() => {
                alarmSound.pause();
                alarmSound.currentTime = 0;
                alarmSound.volume = 1; // ë³¼ë¥¨ ë³µì›
            }).catch(() => {
                // ì¬ìƒ ê¶Œí•œ ê±°ë¶€ ì‹œ ë¬´ì‹œ
            });
    
            const startTime = performance.now() - (totalTime - timeLeft) * 1000;
    
            timerInterval = setInterval(() => {
                const now = performance.now();
                const elapsed = (now - startTime) / 1000;
                timeLeft = totalTime - elapsed;
    
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timeLeft = 0;
                    updateDisplay();
                    alarmSound.play();
                    alert("â° ì‹œê°„ì´ ëë‚¬ìŠµë‹ˆë‹¤!");
                    alarmSound.pause();        // ì—¬ê¸°ì„œ ì¬ìƒ ë©ˆì¶¤
                    alarmSound.currentTime = 0; // ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì¬ìƒ ì¤€ë¹„
                    stopButton.classList.add("hidden");
                    playButton.classList.remove("hidden");
                    return;
                }
    
                updateDisplay();
            }, 50);
        });
    
        stopButton.addEventListener("click", stopTimer);
        resetButton.addEventListener("click", resetTimer);
    
        // ğŸŸ¢ ê³¼ëª© ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        document.querySelectorAll(".subject-btn").forEach(btn => {
            btn.addEventListener("click", () => {
                // 1. ì „ì²´ ë²„íŠ¼ì—ì„œ ë°°ê²½ ì œê±°
                document.querySelectorAll(".subject-btn").forEach(b => {
                    b.classList.remove("bg-white", "shadow", "rounded-lg");
                });
    
                // 2. í˜„ì¬ ë²„íŠ¼ ê°•ì¡°
                btn.classList.add("bg-white", "shadow", "rounded-lg");
    
                // 3. ì‹œê°„ ë° ìƒ‰ìƒ ë³€ê²½
                totalTime = parseInt(btn.getAttribute("data-time"));
                timeLeft = totalTime;
                currentColor = btn.getAttribute("data-color");
    
                updateDisplay();
                stopTimer(); // ì‹¤í–‰ ì¤‘ì´ë©´ ë©ˆì¶¤
            });
        });
    
        updateDisplay(); // ì´ˆê¸° í‘œì‹œ
    </script>

</body>
</html>
