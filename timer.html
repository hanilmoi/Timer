<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hanil Timer</title>

  <link rel="icon" href="/Timer/favicon.ico" type="image/x-icon" />
  <link rel="manifest" href="/Timer/manifest.json" />

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Anonymous+Pro&family=Nanum+Myeongjo&display=swap" rel="stylesheet">

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            Inter: ['Inter', 'sans-serif'],
            Anonymous_Pro: ['"Anonymous Pro"', 'monospace'],
            NanumMyeongjo: ['"Nanum Myeongjo"', 'serif']
          },
          colors: {
            hanilgreen: "#00AF84",
            graylight: "#F0F0F0",
            graymid: "#DFDFDF",
            graybg: "#F7F7F7",
            darkgray: "#444444"
          }
        }
      }
    }
  </script>
  <style>
    #fillCircle {
      background: conic-gradient(#f0f0f0 0%, #CFDFFF 0%);
      transition: background 1s linear;
    }
  </style>
</head>
<body class="bg-white font-Inter">
  <!-- ì‚¬ì´ë“œë°” -->
  <aside class="fixed left-0 top-0 w-[180px] h-screen bg-white border-r border-graymid p-6 flex flex-col justify-between">
    <div>
      <h1 class="text-black text-xl font-semibold mb-10">HANIL TIMER</h1>
      <nav class="space-y-2">
        <div class="px-2 h-10 flex items-center gap-4">
          <span class="text-black text-base font-semibold">Features</span>
        </div>
        <a href="index.html" class="block px-2 h-10 flex items-center gap-4 hover:bg-graybg rounded-lg">
          <img src="/Timer/images/PracticeExamTimer.png" alt="ëª¨ì˜ê³ ì‚¬" class="w-[25px] h-[25px]" />
          <span class="text-black text-base font-medium">ëª¨ì˜ê³ ì‚¬</span>
        </a>
        <a href="stopwatch.html" class="block px-2 h-10 flex items-center gap-4 hover:bg-graybg rounded-lg">
          <img src="/Timer/images/Stopwatch.png" alt="ìŠ¤í†±ì›Œì¹˜" class="w-[25px] h-[26px]" />
          <span class="text-black text-base font-medium">ìŠ¤í†±ì›Œì¹˜</span>
        </a>
        <div class="px-2 h-10 flex items-center gap-4 bg-graybg rounded-lg">
          <img src="/Timer/images/Timer.png" alt="íƒ€ì´ë¨¸" class="w-[25px] h-[25px]" />
          <span class="text-black text-base font-medium">íƒ€ì´ë¨¸</span>
        </div>
      </nav>
    </div>
    <div class="mt-4">
      <label for="alarmFileInput" class="text-black text-sm font-medium block mb-1">ğŸ”” ì•ŒëŒ ì†Œë¦¬ ì„ íƒ</label>
      <input type="file" id="alarmFileInput" accept="audio/*" class="text-sm w-full" />
    </div>
  </aside>

  <!-- ìƒë‹¨ë°” -->
  <header class="ml-[180px] w-[906px] h-[197px] p-8">
    <div class="flex justify-between items-center mb-8">
      <div class="flex space-x-2 bg-graybg p-1 rounded-lg" id="changeButtons">
        <div class="change-btn px-3 h-8 bg-white rounded-lg shadow flex items-center text-black text-base font-medium cursor-pointer" data-change="íƒ€ì´ë¨¸1" data-time="10">íƒ€ì´ë¨¸1</div>
        <div class="change-btn px-3 h-8 flex items-center text-black text-base font-medium cursor-pointer" data-change="íƒ€ì´ë¨¸2" data-time="20">íƒ€ì´ë¨¸2</div>
        <div class="change-btn px-3 h-8 flex items-center text-black text-base font-medium cursor-pointer" data-change="íƒ€ì´ë¨¸3" data-time="30">íƒ€ì´ë¨¸3</div>
      </div>
      <div class="h-10 px-4 bg-black text-white text-base font-medium rounded-lg flex items-center">for Hanil High</div>
    </div>
    <h2 class="text-black text-[34px] font-semibold">íƒ€ì´ë¨¸</h2>
    <p class="text-darkgray text-base font-normal">Timer</p>
  </header>

  <!-- ë©”ì¸ íƒ€ì´ë¨¸ -->
  <main class="ml-[174px] w-[906px] flex justify-center items-center h-[400px] relative">
    <section class="Clock w-[566px] h-[250px] relative overflow-hidden">
      <div class="w-[250px] h-[250px] absolute left-[158px] top-0">
        <div id="progressCircle" class="w-full h-full rounded-full relative">
          <div id="fillCircle" class="absolute inset-0 rounded-full bg-[conic-gradient(#f0f0f0_0%,#00af84_0%)] transition-background duration-1000 ease-linear"></div>
          <div class="absolute inset-[15.62px] rounded-full bg-white shadow-[inset_0_4px_10px_rgba(0,0,0,0.25)]"></div>
        </div>
      </div>

      <button id="resetButton" class="w-[100px] h-[100px] absolute left-[466px] top-[65px] cursor-pointer">
        <div class="w-full h-full bg-[#f0f0f0] rounded-full shadow-[inset_0_1px_10px_rgba(0,0,0,0.25)]"></div>
        <img src="/Timer/images/Reset.png" class="w-[41.67px] h-[41.67px] absolute left-[29px] top-[29px]" />
      </button>

      <button id="playButton" class="w-[100px] h-[100px] absolute left-0 top-[65px] cursor-pointer">
        <div class="w-full h-full bg-[#f0f0f0] rounded-full shadow-[inset_0_1px_10px_rgba(0,0,0,0.25)]"></div>
        <img src="/Timer/images/Play.png" class="w-[41.67px] h-[41.67px] absolute left-[33px] top-[29px]" />
      </button>

      <button id="stopButton" class="w-[100px] h-[100px] absolute left-0 top-[65px] cursor-pointer hidden">
        <div class="w-full h-full bg-[#f0f0f0] rounded-full shadow-[inset_0_1px_10px_rgba(0,0,0,0.25)]"></div>
        <img src="/Timer/images/Stop.png" class="w-[33.33px] h-[33.33px] absolute left-[33px] top-[33px]" />
      </button>

      <div class="timer-text absolute left-[217px] top-[89px] flex justify-center text-black text-5xl font-normal font-['Anonymous_Pro'] leading-[72px] cursor-pointer">
        00:00
      </div>
    </section>

    <!-- íˆ¬ëª… ê²€ì • ë°°ê²½ + ì„¤ì • ëª¨ë‹¬ -->
    <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center hidden z-50">
      <div class="bg-[#f0f0f0] rounded-[20px] w-[540px] h-[350px] relative">
        <div class="p-8">
          <h2 class="text-[28px] font-semibold">ì‹œê°„ ì„¤ì •</h2>
          <div class="flex justify-center items-center gap-4 mt-6">
            <input id="inputHour" type="number" min="0" max="99" value="0" class="w-[80px] text-center text-4xl rounded p-2 bg-white" />
            <span class="text-4xl">:</span>
            <input id="inputMin" type="number" min="0" max="59" value="0" class="w-[80px] text-center text-4xl rounded p-2 bg-white" />
            <span class="text-4xl">:</span>
            <input id="inputSec" type="number" min="0" max="59" value="0" class="w-[80px] text-center text-4xl rounded p-2 bg-white" />
          </div>
          <div class="text-center mt-8">
            <button id="confirmTime" class="px-6 py-2 bg-blue-500 text-white rounded-md">í™•ì¸</button>
          </div>
        </div>
      </div>
    </div>

    <div class="fixed bottom-4 right-4 text-black text-xl font-NanumMyeongjo">í•œì¼ê³ ë“±í•™êµ í•™ìƒìì¹˜ì •ë¶€ ì •ë³´ë¶€</div>
  </main>

  <script>
    const timerDisplay = document.querySelector(".timer-text");
    const playButton = document.getElementById("playButton");
    const stopButton = document.getElementById("stopButton");
    const resetButton = document.getElementById("resetButton");
    const fillCircle = document.getElementById("fillCircle");
    const alarmInput = document.getElementById("alarmFileInput");

    const overlay = document.getElementById("overlay");
    const inputHour = document.getElementById("inputHour");
    const inputMin = document.getElementById("inputMin");
    const inputSec = document.getElementById("inputSec");
    const confirmTime = document.getElementById("confirmTime");

    let alarmSound = null;
    alarmInput.addEventListener("change", e => {
      const file = e.target.files[0];
      if (file) {
        alarmSound = new Audio(URL.createObjectURL(file));
        alarmSound.load();
        alert("âœ… ì•ŒëŒ ì†Œë¦¬ íŒŒì¼ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤!");
      }
    });

    const changeStates = {
      "íƒ€ì´ë¨¸1": { timeLeft: 10, running: false },
      "íƒ€ì´ë¨¸2": { timeLeft: 20, running: false },
      "íƒ€ì´ë¨¸3": { timeLeft: 30, running: false }
    };

    let currentChange = "íƒ€ì´ë¨¸1";
    let totalTime = 10;
    let timeLeft = totalTime;
    let timerInterval = null;

    function updateProgress() {
      const percent = (1 - timeLeft / totalTime) * 100;
      fillCircle.style.background = `conic-gradient(#f0f0f0 ${percent}%, #CFDFFF ${percent}%)`;
    }

    function updateDisplay() {
      const t = Math.max(0, Math.floor(timeLeft));
      const m = Math.floor(t / 60);
      const s = t % 60;
      timerDisplay.textContent = `${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
      updateProgress();
    }

    function stopTimer() {
      clearInterval(timerInterval);
      timerInterval = null;
      changeStates[currentChange].running = false;
      changeStates[currentChange].timeLeft = timeLeft;
      stopButton.classList.add("hidden");
      playButton.classList.remove("hidden");
    }

    function resetTimer() {
      stopTimer();
      timeLeft = totalTime;
      updateDisplay();
      changeStates[currentChange].timeLeft = timeLeft;
    }

    function startTimer() {
      playButton.classList.add("hidden");
      stopButton.classList.remove("hidden");
      changeStates[currentChange].running = true;

      const startTime = performance.now() - (totalTime - timeLeft) * 1000;
      timerInterval = setInterval(() => {
        const now = performance.now();
        const elapsed = (now - startTime) / 1000;
        timeLeft = totalTime - elapsed;

        if (timeLeft <= 0) {
          stopTimer();
          timeLeft = 0;
          updateDisplay();
          if (alarmSound) alarmSound.play();
          alert("â° ì‹œê°„ì´ ëë‚¬ìŠµë‹ˆë‹¤!");
          alarmSound.pause();
          alarmSound.currentTime = 0;
          return;
        }
        updateDisplay();
      }, 50);
    }

    function switchChange(change) {
      if (currentChange === change) return;
      if (timerInterval !== null) stopTimer();
      changeStates[currentChange].timeLeft = timeLeft;
      changeStates[currentChange].running = (timerInterval !== null);

      currentChange = change;
      totalTime = parseInt(document.querySelector(`[data-change="${change}"]`).dataset.time);
      timeLeft = changeStates[change].timeLeft;
      updateDisplay();

      if (changeStates[change].running) startTimer();
    }

    playButton.addEventListener("click", startTimer);
    stopButton.addEventListener("click", stopTimer);
    resetButton.addEventListener("click", resetTimer);

    document.querySelectorAll(".change-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".change-btn").forEach(b => b.classList.remove("bg-white", "shadow", "rounded-lg"));
        btn.classList.add("bg-white", "shadow", "rounded-lg");
        switchChange(btn.dataset.change);
      });
    });

    timerDisplay.addEventListener("click", () => {
      overlay.classList.remove("hidden");
    });

    confirmTime.addEventListener("click", () => {
      const h = parseInt(inputHour.value) || 0;
      const m = parseInt(inputMin.value) || 0;
      const s = parseInt(inputSec.value) || 0;
      const newTotal = h * 3600 + m * 60 + s;

      if (newTotal > 0) {
        totalTime = newTotal;
        timeLeft = newTotal;
        changeStates[currentChange].timeLeft = newTotal;
        updateDisplay();
      }

      overlay.classList.add("hidden");
    });

    updateDisplay();
  </script>
</body>
</html>
